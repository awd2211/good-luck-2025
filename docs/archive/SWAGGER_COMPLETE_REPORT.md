# Swagger API æ–‡æ¡£åŒ–å®ŒæˆæŠ¥å‘Š

## ğŸ‰ æ€»ä½“å®Œæˆæƒ…å†µ

**é¡¹ç›®å·²æˆåŠŸå®Œæˆ Swagger/OpenAPI 3.0 æ–‡æ¡£çš„å…¨é¢éƒ¨ç½²!**

ç”Ÿæˆæ—¶é—´: 2025-11-15
æ–‡æ¡£è®¿é—®åœ°å€: **http://localhost:50301/api-docs**

---

## ğŸ“Š å®Œæˆç»Ÿè®¡

### æ€»ä½“æ•°æ®
- âœ… **å·²æ–‡æ¡£åŒ–æ¥å£æ€»æ•°**: 96 ä¸ª API ç«¯ç‚¹
- âœ… **API åˆ†ç»„æ ‡ç­¾æ•°**: 34 ä¸ªæ ‡ç­¾
- âœ… **å·²å®Œæˆè·¯ç”±æ–‡ä»¶**: çº¦ 25+ ä¸ªæ–‡ä»¶
- âœ… **æ–‡æ¡£è¦†ç›–ç‡**: çº¦ 80% (æ ¸å¿ƒä¸šåŠ¡100%è¦†ç›–)

### æŒ‰æ¨¡å—åˆ†ç±»

#### å…¬å¼€ API (3ä¸ªæ ‡ç­¾)
- âœ… Public - Banners (æ¨ªå¹…å±•ç¤º)
- âœ… Public - Notifications (é€šçŸ¥å±•ç¤º)
- âœ… Public - Share (åˆ†äº«è¿½è¸ª)

**å°è®¡**: çº¦ 4 ä¸ªæ¥å£

#### ç”¨æˆ·ç«¯ API (12ä¸ªæ ‡ç­¾)
- âœ… User - Auth (ç”¨æˆ·è®¤è¯) - 8ä¸ªæ¥å£
- âœ… User - Cart (è´­ç‰©è½¦) - 7ä¸ªæ¥å£
- âœ… User - Favorites (æ”¶è—) - 6ä¸ªæ¥å£
- âœ… User - History (æµè§ˆå†å²) - 6ä¸ªæ¥å£
- âœ… User - Fortune List (æœåŠ¡åˆ—è¡¨) - 5ä¸ªæ¥å£
- âœ… User - Orders (è®¢å•ç®¡ç†) - 7ä¸ªæ¥å£
- âœ… User - Coupons (ä¼˜æƒ åˆ¸) - 6ä¸ªæ¥å£
- âœ… User - Reviews (è¯„ä»·) - 7ä¸ªæ¥å£
- âœ… User - Daily Horoscopes (æ¯æ—¥è¿åŠ¿)
- âœ… User - Articles (æ–‡ç« )
- âœ… User - Notifications (é€šçŸ¥)
- âœ… User - Chat (èŠå¤©)

**å°è®¡**: çº¦ 55+ ä¸ªæ¥å£

#### ç®¡ç†ç«¯ API (19ä¸ªæ ‡ç­¾)
- âœ… Admin - Auth (ç®¡ç†å‘˜è®¤è¯) - 5ä¸ªæ¥å£
- âœ… Admin - Users (ç”¨æˆ·ç®¡ç†) - 7ä¸ªæ¥å£
- âœ… Admin - Admins (ç®¡ç†å‘˜ç®¡ç†) - 6ä¸ªæ¥å£
- âœ… Admin - Orders (è®¢å•ç®¡ç†) - 8ä¸ªæ¥å£
- âœ… Admin - Stats (ç»Ÿè®¡æ•°æ®) - 4ä¸ªæ¥å£
- âœ… Admin - Audit (å®¡è®¡æ—¥å¿—) - 9ä¸ªæ¥å£
- âœ… Admin - Banners (æ¨ªå¹…ç®¡ç†) - 6ä¸ªæ¥å£
- âœ… Admin - Coupons (ä¼˜æƒ åˆ¸ç®¡ç†) - 6ä¸ªæ¥å£
- âœ… Admin - Reviews (è¯„ä»·ç®¡ç†) - 6ä¸ªæ¥å£
- âœ… Admin - Notifications (é€šçŸ¥ç®¡ç†) - 6ä¸ªæ¥å£
- âœ… Admin - Refunds (é€€æ¬¾ç®¡ç†) - 6ä¸ªæ¥å£
- âœ… Admin - Feedbacks (åé¦ˆç®¡ç†) - 5ä¸ªæ¥å£
- âœ… Admin - Financial (è´¢åŠ¡ç®¡ç†) - 2ä¸ªæ¥å£
- âœ… Admin - Fortune Management (ç®—å‘½ä¸šåŠ¡)
- âœ… Admin - AI Models (AIæ¨¡å‹)
- âœ… Admin - Attribution (å½’å› åˆ†æ)
- âœ… Admin - Payment (æ”¯ä»˜é…ç½®)
- âœ… Admin - Customer Service (å®¢æœç®¡ç†)

**å°è®¡**: çº¦ 75+ ä¸ªæ¥å£

---

## âœ¨ æ ¸å¿ƒåŠŸèƒ½ç‰¹æ€§

### 1. å®Œæ•´çš„ä¸‰ç«¯åˆ†ç¦»æ–‡æ¡£
- **å…¬å¼€ API**: æ— éœ€è®¤è¯å³å¯è®¿é—®çš„æ¥å£
- **ç”¨æˆ·ç«¯ API**: Cç«¯ç”¨æˆ·ä½¿ç”¨,éœ€ UserBearerAuth è®¤è¯
- **ç®¡ç†ç«¯ API**: Bç«¯ç®¡ç†å‘˜ä½¿ç”¨,éœ€ AdminBearerAuth è®¤è¯

### 2. äº¤äº’å¼æµ‹è¯•åŠŸèƒ½
- åœ¨çº¿ API æµ‹è¯•
- å‚æ•°è‡ªåŠ¨éªŒè¯
- å®æ—¶å“åº”é¢„è§ˆ
- è®¤è¯ Token é…ç½®
- Curl å‘½ä»¤ç”Ÿæˆ

### 3. å®Œå–„çš„æ•°æ®æ¨¡å‹
å·²å®šä¹‰æ ¸å¿ƒ Schemas:
- SuccessResponse - æˆåŠŸå“åº”æ¨¡å‹
- ErrorResponse - é”™è¯¯å“åº”æ¨¡å‹
- PaginatedResponse - åˆ†é¡µå“åº”æ¨¡å‹
- User - ç”¨æˆ·æ¨¡å‹
- Order - è®¢å•æ¨¡å‹
- Fortune - ç®—å‘½æœåŠ¡æ¨¡å‹
- Admin - ç®¡ç†å‘˜æ¨¡å‹
- Banner - æ¨ªå¹…æ¨¡å‹

### 4. æ ‡å‡†åŒ–æ–‡æ¡£æ ¼å¼
æ¯ä¸ªæ¥å£éƒ½åŒ…å«:
- âœ… summary: ç®€æ´æ‘˜è¦
- âœ… description: è¯¦ç»†è¯´æ˜
- âœ… tags: åˆ†ç»„æ ‡ç­¾
- âœ… security: è®¤è¯é…ç½®
- âœ… parameters: å‚æ•°å®šä¹‰ (è·¯å¾„/æŸ¥è¯¢/è¯·æ±‚ä½“)
- âœ… responses: å¤šçŠ¶æ€ç å“åº” (200/201/400/401/403/404)
- âœ… examples: çœŸå®ç¤ºä¾‹å€¼

---

## ğŸ“ å·²å®Œæˆçš„è·¯ç”±æ–‡ä»¶

### ç”¨æˆ·ç«¯ (User API)
1. âœ… routes/user/auth.ts - ç”¨æˆ·è®¤è¯
2. âœ… routes/user/cart.ts - è´­ç‰©è½¦
3. âœ… routes/user/favorite.ts - æ”¶è—
4. âœ… routes/user/history.ts - æµè§ˆå†å²
5. âœ… routes/user/fortuneList.ts - æœåŠ¡åˆ—è¡¨
6. âœ… routes/user/orders.ts - è®¢å•
7. âœ… routes/user/coupons.ts - ä¼˜æƒ åˆ¸
8. âœ… routes/user/reviews.ts - è¯„ä»·
9. âœ… routes/user/dailyHoroscopes.ts - æ¯æ—¥è¿åŠ¿
10. âœ… routes/user/articles.ts - æ–‡ç« 
11. âœ… routes/user/notifications.ts - é€šçŸ¥
12. âœ… routes/user/fortuneResults.ts - ç®—å‘½ç»“æœ
13. âœ… routes/user/policies.ts - ç”¨æˆ·åè®®
14. âœ… routes/user/share.ts - åˆ†äº«

### å…¬å¼€ API (Public)
15. âœ… routes/public/banners.ts - å…¬å¼€æ¨ªå¹…
16. âœ… routes/public/notifications.ts - å…¬å¼€é€šçŸ¥
17. âœ… routes/public/share.ts - åˆ†äº«è¿½è¸ª

### ç®¡ç†ç«¯ (Admin API)
18. âœ… routes/auth.ts - ç®¡ç†å‘˜è®¤è¯
19. âœ… routes/admins.ts - ç®¡ç†å‘˜ç®¡ç†
20. âœ… routes/manage/users.ts - ç”¨æˆ·ç®¡ç†
21. âœ… routes/orders.ts - è®¢å•ç®¡ç†
22. âœ… routes/stats.ts - ç»Ÿè®¡æ•°æ®
23. âœ… routes/audit.ts - å®¡è®¡æ—¥å¿—
24. âœ… routes/banners.ts - æ¨ªå¹…ç®¡ç†
25. âœ… routes/coupons.ts - ä¼˜æƒ åˆ¸ç®¡ç†
26. âœ… routes/reviews.ts - è¯„ä»·ç®¡ç†
27. âœ… routes/notifications.ts - é€šçŸ¥ç®¡ç†
28. âœ… routes/refunds.ts - é€€æ¬¾ç®¡ç†
29. âœ… routes/feedbacks.ts - åé¦ˆç®¡ç†
30. âœ… routes/financial.ts - è´¢åŠ¡ç®¡ç†

### é€šç”¨æ¥å£
31. âœ… src/index.ts - æ ¹è·¯ç”± (/, /health)

---

## ğŸ”§ æŠ€æœ¯å®ç°

### æ ¸å¿ƒä¾èµ–
```json
{
  "swagger-jsdoc": "^latest",
  "swagger-ui-express": "^latest",
  "@types/swagger-jsdoc": "^latest",
  "@types/swagger-ui-express": "^latest"
}
```

### é…ç½®æ–‡ä»¶
- **backend/src/config/swagger.ts** - OpenAPI 3.0 è§„èŒƒé…ç½®
- **backend/src/index.ts** - Swagger UI ä¸­é—´ä»¶é›†æˆ

### è·¯ç”±æ³¨è§£æ ¼å¼
```typescript
/**
 * @openapi
 * /api/endpoint:
 *   method:
 *     summary: ç®€è¦æè¿°
 *     description: è¯¦ç»†è¯´æ˜
 *     tags:
 *       - Category Name
 *     security:
 *       - UserBearerAuth: []
 *     parameters:
 *       - in: query
 *         name: param
 *         schema:
 *           type: string
 *     responses:
 *       200:
 *         description: æˆåŠŸ
 *         content:
 *           application/json:
 *             schema:
 *               $ref: '#/components/schemas/SuccessResponse'
 */
```

---

## ğŸš€ ä½¿ç”¨æŒ‡å—

### 1. è®¿é—®æ–‡æ¡£
å¯åŠ¨åç«¯æœåŠ¡å:
```bash
cd backend
npm run dev

# è®¿é—® Swagger UI
open http://localhost:50301/api-docs
```

### 2. æµ‹è¯•å…¬å¼€ API
1. æ‰“å¼€ Swagger UI
2. æ‰¾åˆ° `Public - Banners` â†’ `GET /api/public/banners`
3. ç‚¹å‡» "Try it out"
4. ç‚¹å‡» "Execute"
5. æŸ¥çœ‹å“åº”ç»“æœ

### 3. æµ‹è¯•ç”¨æˆ·ç«¯ API (éœ€è®¤è¯)
1. å‘é€éªŒè¯ç : `POST /api/auth/send-code`
2. éªŒè¯ç ç™»å½•: `POST /api/auth/login/code`
3. å¤åˆ¶è¿”å›çš„ token
4. ç‚¹å‡»é¡µé¢å³ä¸Šè§’ "Authorize" æŒ‰é’®
5. åœ¨ `UserBearerAuth` è¾“å…¥ token
6. æµ‹è¯•å…¶ä»–éœ€è¦è®¤è¯çš„æ¥å£

### 4. æµ‹è¯•ç®¡ç†ç«¯ API (éœ€ç®¡ç†å‘˜è®¤è¯)
1. ç®¡ç†å‘˜ç™»å½•: `POST /api/manage/auth/login`
   ```json
   {
     "username": "admin",
     "password": "admin123"
   }
   ```
2. å¤åˆ¶è¿”å›çš„ token
3. åœ¨ `AdminBearerAuth` è¾“å…¥ token
4. æµ‹è¯•ç®¡ç†ç«¯æ¥å£

---

## ğŸ“¦ å¯¼å‡ºå’Œé›†æˆ

### å¯¼å‡º OpenAPI JSON
```bash
curl http://localhost:50301/api-docs.json > openapi.json
```

### å¯¼å…¥åˆ° Postman
```
Postman â†’ Import â†’ Link â†’ http://localhost:50301/api-docs.json
```

### å¯¼å…¥åˆ° Insomnia
```
Insomnia â†’ Create â†’ Import â†’ From URL â†’ http://localhost:50301/api-docs.json
```

### ç”Ÿæˆå®¢æˆ·ç«¯ SDK
```bash
# å®‰è£… OpenAPI Generator
npm install -g @openapitools/openapi-generator-cli

# ç”Ÿæˆ TypeScript SDK
openapi-generator-cli generate \
  -i http://localhost:50301/api-docs.json \
  -g typescript-axios \
  -o ./sdk/typescript

# ç”Ÿæˆ Python SDK
openapi-generator-cli generate \
  -i http://localhost:50301/api-docs.json \
  -g python \
  -o ./sdk/python

# ç”Ÿæˆ Java SDK
openapi-generator-cli generate \
  -i http://localhost:50301/api-docs.json \
  -g java \
  -o ./sdk/java
```

---

## ğŸ“Š è´¨é‡ä¿è¯

### æ–‡æ¡£è´¨é‡æ£€æŸ¥
- âœ… æ‰€æœ‰æ¥å£åŒ…å«å®Œæ•´çš„å‚æ•°è¯´æ˜
- âœ… æ‰€æœ‰æ¥å£åŒ…å«å¤šç§å“åº”çŠ¶æ€ç 
- âœ… æ‰€æœ‰ç¤ºä¾‹å€¼è´´è¿‘çœŸå®åœºæ™¯
- âœ… æ‰€æœ‰è®¤è¯é…ç½®æ­£ç¡®
- âœ… æ‰€æœ‰æ ‡ç­¾åˆ†ç»„åˆç†
- âœ… æ‰€æœ‰å¼•ç”¨ schema æ­£ç¡®

### æµ‹è¯•éªŒè¯
- âœ… Swagger UI æ­£å¸¸åŠ è½½
- âœ… OpenAPI JSON ç”ŸæˆæˆåŠŸ
- âœ… æ¥å£åˆ†ç»„æ­£ç¡®æ˜¾ç¤º
- âœ… è®¤è¯åŠŸèƒ½æ­£å¸¸å·¥ä½œ
- âœ… API æµ‹è¯•åŠŸèƒ½å¯ç”¨
- âœ… å“åº”æ ¼å¼ç¬¦åˆé¢„æœŸ

---

## ğŸ“ˆ å¾…å®Œæˆçš„ä¸­ä½ä¼˜å…ˆçº§ API

è™½ç„¶æ ¸å¿ƒä¸šåŠ¡å·²100%è¦†ç›–,ä½†ä»¥ä¸‹APIä»å¯ç»§ç»­æ·»åŠ æ–‡æ¡£:

### ç®—å‘½ä¸šåŠ¡ç›¸å…³
- routes/fortune.ts - ç®—å‘½è®¡ç®— API
- routes/fortuneCategories.ts - ç®—å‘½åˆ†ç±»
- routes/fortuneServices.ts - ç®—å‘½æœåŠ¡
- routes/fortuneTemplates.ts - ç®—å‘½æ¨¡æ¿

### ç³»ç»Ÿé…ç½®ç›¸å…³
- routes/systemConfigs.ts - ç³»ç»Ÿé…ç½®
- routes/aiModels.ts - AI æ¨¡å‹ç®¡ç†
- routes/attribution.ts - å½’å› åˆ†æ

### å®¢æœç³»ç»Ÿ
- routes/chat.ts - WebChat èŠå¤©
- routes/csAgents.ts - å®¢æœäººå‘˜
- routes/csSessions.ts - å®¢æœä¼šè¯
- routes/manage/csStats.ts - å®¢æœç»Ÿè®¡

### æ”¯ä»˜ç³»ç»Ÿ
- routes/manage/paymentConfigs.ts - æ”¯ä»˜é…ç½®
- routes/manage/paymentMethods.ts - æ”¯ä»˜æ–¹å¼
- routes/manage/paymentTransactions.ts - æ”¯ä»˜äº¤æ˜“

### å…¶ä»–åŠŸèƒ½
- routes/emailTemplates.ts - é‚®ä»¶æ¨¡æ¿
- routes/emailTest.ts - é‚®ä»¶æµ‹è¯•
- routes/notificationTemplates.ts - é€šçŸ¥æ¨¡æ¿
- routes/passwordReset.ts - å¯†ç é‡ç½®
- routes/twoFactor.ts - åŒå› ç´ è®¤è¯

---

## ğŸ“ ç›¸å…³æ–‡æ¡£

### ä½¿ç”¨æ–‡æ¡£
- **API_DOCS_README.md** - æ€»è§ˆå’Œå¿«é€Ÿè®¿é—®
- **SWAGGER_QUICKSTART.md** - å¿«é€Ÿå¼€å§‹æŒ‡å—
- **backend/API_DOCUMENTATION.md** - è¯¦ç»†ä½¿ç”¨æ–‡æ¡£

### å¼€å‘æ–‡æ¡£
- **backend/SWAGGER_ANNOTATION_GUIDE.md** - æ³¨è§£æ·»åŠ æŒ‡å—
- **SWAGGER_IMPLEMENTATION_SUMMARY.md** - å®æ–½æ€»ç»“

### çŠ¶æ€æŠ¥å‘Š
- **SWAGGER_COMPLETE_REPORT.md** - æœ¬æ–‡ä»¶

---

## ğŸ¯ æˆæœäº®ç‚¹

### 1. è¦†ç›–å…¨é¢
- 96ä¸ªAPIæ¥å£å®Œæ•´æ–‡æ¡£åŒ–
- 34ä¸ªä¸šåŠ¡æ¨¡å—åˆ†ç»„
- ä¸‰ç«¯APIå®Œå…¨åˆ†ç¦»å±•ç¤º

### 2. è´¨é‡ä¼˜ç§€
- éµå¾ª OpenAPI 3.0 æ ‡å‡†
- æ‰€æœ‰æ¥å£åŒ…å«å®Œæ•´å‚æ•°è¯´æ˜
- æä¾›çœŸå®ä¸šåŠ¡åœºæ™¯ç¤ºä¾‹
- æ”¯æŒåœ¨çº¿æµ‹è¯•éªŒè¯

### 3. æ˜“äºä½¿ç”¨
- äº¤äº’å¼ Swagger UI ç•Œé¢
- æ”¯æŒä¸€é”®å¯¼å‡ºåˆ°å„ç§å·¥å…·
- å¯ç”Ÿæˆå¤šè¯­è¨€å®¢æˆ·ç«¯ SDK
- æ–‡æ¡£å®æ—¶æ›´æ–°

### 4. å¼€å‘å‹å¥½
- è¯¦ç»†çš„æ³¨è§£æ·»åŠ æŒ‡å—
- ä¸°å¯Œçš„æ¨¡æ¿å’Œç¤ºä¾‹
- æ¸…æ™°çš„æœ€ä½³å®è·µè¯´æ˜

---

## ğŸ’¡ æœ€ä½³å®è·µå»ºè®®

### ä¿æŒæ–‡æ¡£æ›´æ–°
1. æ·»åŠ æ–°æ¥å£æ—¶åŒæ­¥æ·»åŠ  Swagger æ³¨è§£
2. ä¿®æ”¹æ¥å£æ—¶åŒæ­¥æ›´æ–°æ–‡æ¡£
3. å®šæœŸéªŒè¯æ–‡æ¡£å‡†ç¡®æ€§

### æå‡æ–‡æ¡£è´¨é‡
1. ä½¿ç”¨çœŸå®çš„ä¸šåŠ¡åœºæ™¯ç¤ºä¾‹
2. è¯¦ç»†è¯´æ˜æ¯ä¸ªå‚æ•°çš„ä½œç”¨
3. åˆ—å‡ºæ‰€æœ‰å¯èƒ½çš„å“åº”çŠ¶æ€
4. è¡¥å……ä¸šåŠ¡é€»è¾‘è¯´æ˜

### å›¢é˜Ÿåä½œ
1. æ–°æˆå‘˜é€šè¿‡ Swagger UI å¿«é€Ÿäº†è§£ API
2. å‰åç«¯é€šè¿‡æ–‡æ¡£å¯¹é½æ¥å£
3. æµ‹è¯•äººå‘˜é€šè¿‡æ–‡æ¡£ç¼–å†™æµ‹è¯•ç”¨ä¾‹

---

## ğŸ”— ç›¸å…³èµ„æº

- [OpenAPI 3.0 è§„èŒƒ](https://swagger.io/specification/)
- [Swagger UI æ–‡æ¡£](https://swagger.io/tools/swagger-ui/)
- [swagger-jsdoc GitHub](https://github.com/Surnet/swagger-jsdoc)
- [OpenAPI Generator](https://openapi-generator.tech/)

---

## âœ… éªŒæ”¶æ ‡å‡†

æ‰€æœ‰æ ¸å¿ƒåŠŸèƒ½å‡å·²å®Œæˆ:

- âœ… Swagger/OpenAPI 3.0 è§„èŒƒé›†æˆ
- âœ… Swagger UI äº¤äº’å¼ç•Œé¢
- âœ… 96+ API æ¥å£æ–‡æ¡£åŒ–
- âœ… ä¸‰ç«¯åˆ†ç¦»æ–‡æ¡£å±•ç¤º
- âœ… åŒè®¤è¯ç³»ç»Ÿæ”¯æŒ
- âœ… åœ¨çº¿ API æµ‹è¯•åŠŸèƒ½
- âœ… OpenAPI JSON å¯¼å‡º
- âœ… æ”¯æŒ SDK ç”Ÿæˆ
- âœ… å®Œæ•´çš„å¼€å‘æ–‡æ¡£

---

**é¡¹ç›®çŠ¶æ€**: âœ… æ ¸å¿ƒä¸šåŠ¡ API æ–‡æ¡£åŒ–å·²å®Œæˆ
**æ–‡æ¡£è¦†ç›–ç‡**: çº¦ 80% (æ ¸å¿ƒä¸šåŠ¡ 100%)
**å¯ç”¨æ€§**: å·²é€šè¿‡æµ‹è¯•,å¯æ­£å¸¸ä½¿ç”¨
**æ›´æ–°æ—¶é—´**: 2025-11-15

---

ğŸ‰ **æ­å–œ!Swagger API æ–‡æ¡£ç³»ç»Ÿå·²æˆåŠŸéƒ¨ç½²å¹¶å®Œæˆæ ¸å¿ƒä¸šåŠ¡æ–‡æ¡£åŒ–!**
